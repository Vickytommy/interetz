{% load filters %}
{% include 'super_admin/partials/main.html' %}
{% include 'super_admin/partials/title-meta.html' with title="Export Order Data To CSV" %}

<head>

    {% load static %}
    {% load filters %}
    <link rel="stylesheet" href="{% static 'super_admin/assets/js/datatables/buttons.datatables.min.css' %}">
    <link href="{% static 'super_admin/assets/libs/sweetalert2/sweetalert2.min.css' %}" rel="stylesheet" type="text/css" />
    
    {% include 'super_admin/partials/head-css.html' %}

</head>

{% include 'super_admin/partials/body.html' %}
<div class="group-data-[sidebar-size=sm]:min-h-[1500px] group-data-[sidebar-size=sm]:relative">
    {% include 'super_admin/partials/sidebar.html' %}
    {% include 'super_admin/partials/topbar.html' %}


    <!-- ============================================================== -->
    <!-- Start right Content here -->
    <!-- ============================================================== -->
    <div class="relative min-h-screen group-data-[sidebar-size=sm]:min-h-[1500px]">

        <div class="group-data-[sidebar-size=lg]:ltr:lg:ml-vertical-menu group-data-[sidebar-size=lg]:rtl:lg:mr-vertical-menu group-data-[sidebar-size=md]:ltr:ml-vertical-menu-md group-data-[sidebar-size=md]:rtl:mr-vertical-menu-md group-data-[sidebar-size=sm]:ltr:lg:ml-vertical-menu-sm group-data-[sidebar-size=sm]:lg:rtl:mr-vertical-menu-sm pt-[calc(theme('spacing.header')_*_1)] pb-[calc(theme('spacing.header')_*_1)] px-6 group-data-[layout=horizontal]:!mx-auto group-data-[layout=horizontal]:max-w-screen-2xl  group-data-[layout=horizontal]:lg:pt-[calc(theme('spacing.header')_*_1.75)] ">
            <div class="container-fluid">

               
                {% include 'super_admin/partials/page-title.html' with title=request.session|get:"Orders" pagetitle="Export order to csv" %}
                 {% include 'super_admin/partials/custom_modal.html' %}

                

                
                <div>
                    <div class="shadow-md card shadow-gray-400/10 dark:bg-zink-700 dark:border-zink-50">
                        <div class="pb-0 card-body">
                            <h6 class="font-semibold text-15 mb-3 dark:text-white">CSV Data</h6>
                            
                            <table id="basic_tables" class="display group border-collapse border border-gray-300 dark:border-zink-50" style="width:100%">
                                <thead>
                                    <tr>
                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">PartRef</th>
                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">Materiael</th>
                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">Grai</th> Direction
                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">PartL</th>
                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">PartW</th>
                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">Qty</th>
                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">PartEdge1</th>
                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">PartEdge2</th>
                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">PartEdge3</th>
                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">PartEdge4</th>

                                             <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">PartExt01</th>
                                           <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">PartDrawing</th>
                                       

                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">PartFRef</th>
                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">PartFExt01</th>
                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">PartFExt02</th>
                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">PartFExt03</th>
                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">PartFExt04</th>
                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">PartFExt05</th>
                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">PartFExt06</th>
                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">PartFExt07</th>
                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">PartFExt08</th>
                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">PartFExt09</th>
                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">PartFExt10</th>
                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">PartFExt11</th>
                                        <th class="text-center border border-gray-300 dark:border-zink-50 bg-transparent">PartFExt12</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for row in rows %}
                                        <tr>
                                            <td>{{ row.PartRef }}</td>
                                            <td>{{ row.Materiael }}</td>
                                            <td>{{ row.GraiDirection }}</td>
                                            <td>{{ row.PartL }}</td>
                                            <td>{{ row.PartW }}</td>
                                            <td>{{ row.Qty }}</td>
                                            <td>{{ row.PartEdge1 }}</td>
                                            <td>{{ row.PartEdge2 }}</td>
                                            <td>{{ row.PartEdge3 }}</td>
                                            <td>{{ row.PartEdge4 }}</td>
                                            
                                            <td>{{ row.PartExt01 }}</td>
                                            <td>{{ row.PartDrawing }}</td>
                                             
                                            <td>{{ row.PartFRef }}</td>
                                            <td>{{ row.PartFExt01 }}</td>
                                            <td>{{ row.PartFExt02 }}</td>
                                            <td>{{ row.PartFExt03 }}</td>
                                            <td>{{ row.PartFExt04 }}</td>
                                            <td>{{ row.PartFExt05 }}</td>
                                            <td>{{ row.PartFExt06}}</td>
                                            <td>{{ row.PartFExt07 }}</td>
                                            <td>{{ row.PartFExt08 }}</td>
                                            <td>{{ row.PartFExt09 }}</td>
                                            <td>{{ row.PartFExt10 }}</td>
                                            <td>{{ row.PartFExt11 }}</td>
                                            <td>{{ row.PartFExt12 }}</td>
                                            

                                        </tr>
                                    {% endfor %}
                                    
                                </tbody>
                                
                            </table>
                        </div>
                    </div>

                </div>
            </div>
            <!-- container-fluid -->
        </div>
        <!-- End Page-content -->
       
        {% include 'super_admin/partials/footer.html' %}
    </div>
</div>
<!-- end main content -->

{% include 'super_admin/partials/customizer.html' %}
{% include 'super_admin/partials/vendor-scripts.html' %}

<script src="{% static 'super_admin/assets/js/datatables/jquery-3.7.0.js' %}"></script>
<script src="{% static 'super_admin/assets/js/datatables/data-tables.min.js' %}"></script>
<script src="{% static 'super_admin/assets/js/datatables/data-tables.tailwindcss.min.js' %}"></script>
<!--buttons dataTables-->
<script src="{% static 'super_admin/assets/js/datatables/datatables.buttons.min.js' %}"></script>
<script src="{% static 'super_admin/assets/js/datatables/jszip.min.js' %}"></script>
<script src="{% static 'super_admin/assets/js/datatables/pdfmake.min.js' %}"></script>
<script src="{% static 'super_admin/assets/js/datatables/vfs_fonts.js' %}"></script>
<script src="{% static 'super_admin/assets/js/datatables/buttons.html5.min.js' %}"></script>
<script src="{% static 'super_admin/assets/js/datatables/buttons.print.min.js' %}"></script>
<!-- <script src="{% static 'super_admin/assets/js/datatables/datatables.init.js' %}"></script> -->

<script src="{% static 'super_admin/assets/libs/sweetalert2/sweetalert2.min.js' %}"></script>
<script type="text/javascript">
    
    var mapping = {
        search: 'חפש',
        sFirst: 'ראשון', 
        sLast: 'אחרון', 
        sNext: 'הבא', 
        sPrevious: 'הקודם',
        export_excel: 'יצא לאקסל',
        csv_error_msg: 'ניתן לטעון קבצי CSV בלבד',

        //sweet alerts
        sure_msg:'אתה בטוח',
        revert_msg:'לא ניתן לשחזר את הפעולה',
       
        delete_msg: 'כן, מחק',
        no_cancel: 'לא, בטל',
        deleted: 'נמחק',
        cancelled: 'בוטל',
        action_msg:  'הפעולה לא בוצעה',


    };
    window.page = mapping;
    $(document).ready(function(){
        var datatable = $('#basic_tables').DataTable({
            buttons: [
                    {
                        extend: 'csvHtml5',
                        text: window.page.export_excel,
                        filename: '{{ order_id }}',
                         bom:true,
                        // customize: function(xlsx) {
                        //     var sheet = xlsx.xl.worksheets['sheet1.xml'];
                        //     var rows = $('row', sheet);
                        //     if (rows.length > 0) {
                        //         rows.first().remove();
                        //     }
                        //     // $('row:first', sheet).remove();
                        // }
                    }
                ],
                dom: 'Bfrtip',
                scrollX: true,
                autoWidth: true,

        });
        
    });
</script>
<!-- Datatable init js -->

<script src="{% static 'super_admin/assets/js/app.js' %}"></script>
</body>
</html>